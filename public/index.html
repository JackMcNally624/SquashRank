<!DOCTYPE html>
<html xmlns="http:\\www.w3.org\1999\xhtml">
<head>
      <meta charset="utf-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >
    <title>Simple Responsive Admin</title>
	<!-- BOOTSTRAP STYLES-->
    <link href="assets\css\bootstrap.css" rel="stylesheet" >
     <!-- FONTAWESOME STYLES-->
    <link href="assets\css\font-awesome.css" rel="stylesheet" >
        <!-- CUSTOM STYLES-->
    <link href="assets\css\custom.css" rel="stylesheet" >
	<!-- UIkit CSS -->
	<link rel="stylesheet" href="https:\\cdnjs.cloudflare.com\ajax\libs\uikit\3.1.6\css\uikit.min.css" >
     <!-- GOOGLE FONTS-->
   <link href='http:\\fonts.googleapis.com\css?family=Open+Sans' rel='stylesheet' type='text\css' >
   <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https:\\maxcdn.bootstrapcdn.com\bootstrap\3.4.0\css\bootstrap.min.css">
  <script src="https:\\ajax.googleapis.com\ajax\libs\jquery\3.4.1\jquery.min.js"></script>
  <script src="https:\\maxcdn.bootstrapcdn.com\bootstrap\3.4.0\js\bootstrap.min.js"></script>
    <!-- UIkit JS -->
  <script src="https:\\cdnjs.cloudflare.com\ajax\libs\uikit\3.1.6\js\uikit.min.js"></script>
  <script src="https:\\cdnjs.cloudflare.com\ajax\libs\uikit\3.1.6\js\uikit-icons.min.js"></script>
</head>
<body>

<div id="wrapper">
			 <div class="navbar navbar-inverse navbar-fixed-top">
				<div class="adjust-nav">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<h1 style="color:white;">ðŸŽ¾ SquashRank</h1>
					</div>
				</div>
			</div>
			<!-- /. NAV TOP  -->
			<nav class="navbar-default navbar-side" role="navigation">
				<div class="sidebar-collapse">
					<ul class="nav" id="main-menu">



						<li class="active-link">
							<a href="index.html" ><i class="fa fa-desktop "></i>Leader Board</a>
						</li>

						<li>
							<a href="loggame.html"><i class="fa fa-plus "></i>Log a Game</a>
						</li>

            <li>
							<a href="addplayer.html"><i class="fa fa-plus "></i>Add a Player</a>
						</li>


					</ul>
								</div>

			</nav>

    <!-- START DYNAMIC  -->
    <div id="page-wrapper" >
    <div id="page-inner">
      <h2>Leader Board</h2>

      <table class="table table-hover">

        <thead>
          <tr>
            <th>Rank</th>
            <th>Player</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody id="tablebody">
          <script>
            getData();
            async function getData() {
              const response = await fetch('/loadplayers');
              const data = await response.json();
              const response2 = await fetch('/loadgames');
              const games = await response2.json();
              var ranknum = 1;

              for (item of data) {
                var wins = 0;
                for (game of games) {
                  if (`${game.winner}` == `${item.name}`) {
                    wins++;
                  }
                }
                item.wins = wins;
              }

              for (let i = 1; i < data.length; i++) {
                let j = i - 1;
                let tmp = data[i];
                while (j >= 0 && data[j].wins < tmp.wins) {
                  data[j + 1] = data[j];
                  j--;
                }
                data[j+1] = tmp;
              }

              for (item of data) {
                const row = document.createElement('tr');
                const rank = document.createElement('td');
                const name = document.createElement('td');
                const score = document.createElement('td');
                rank.textContent = ranknum.toString();
                name.textContent = `${item.name}`;
                score.textContent = `${item.wins}`;
                row.append(rank, name, score);
                document.getElementById("tablebody").append(row);
                ranknum++;
              }
            }
          </script>
        </tbody>
      </table>
    </div>
  </div>
</div>


    <!-- END DYNAMIC  -->

          <!-- /. WRAPPER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    <script src="assets/js/jquery-1.10.2.js"></script>
      <!-- BOOTSTRAP SCRIPTS -->
    <script src="assets/js/bootstrap.min.js"></script>
      <!-- CUSTOM SCRIPTS -->
    <script src="assets/js/custom.js"></script>
</body>
</html>
